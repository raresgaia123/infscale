---
name: resnet152_example
model: microsoft/resnet-152
nfaults: 1
# the following entries are for local development only
# after development is done, they need to be revised accordingly
# to automate building flow_graph, etc.
micro_batch_size: 8
device: cuda:1
fwd_policy: "rr"

stage:
  start: 0
  end: 51
  id: 0-0  # <stage number>-<replica number>, s: serving server
  is_last: True

flow_graph:
  s-0:
    - name: w0
      addr: "127.0.0.1"
      port: 29500
      peers: [0-0]
      backend: nccl
    - name: w1
      addr: "127.0.0.1"
      port: 30500
      peers: [1-0]
      backend: nccl
  0-0:
    - name: w2
      addr: "127.0.0.1"
      port: 31500
      peers: [s-0]
      backend: nccl
  1-0:
    - name: w3
      addr: "127.0.0.1"
      port: 32500
      peers: [s-0]
      backend: nccl

rank_map: # run worker in this rank order
  s-0: 0
  0-0: 1
  1-0: 2

dataset: # huggingface dataset
  path: "cifar10"
  name: ""
  split: test
